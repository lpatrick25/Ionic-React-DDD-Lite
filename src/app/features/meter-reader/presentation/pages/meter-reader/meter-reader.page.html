<ion-content class="home-content">
  <!-- Top Illustration and Welcome Card -->
  <div class="top-illustration">
    <img src="assets/illustration.png" alt="Illustration" />
    <ion-card class="signin-card">
      <ion-card-content>
        <h2>Welcome</h2>
        <p>MacArthur Water System and Services</p>
        <ion-button expand="block" color="primary" shape="round">
          <ion-icon slot="start" name="person-circle-outline"></ion-icon>
          Meter Reader
        </ion-button>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Dashboard Section -->
  <div class="section">
    <div class="section-header">
      <h3>DASHBOARD</h3>
    </div>

    <ion-grid fixed>
      <ion-row>
        <!-- Consumer Card -->
        <ion-col size="6">
          <ion-card class="stat-card consumer-card">
            <ion-card-header>
              <ion-icon name="people-outline"></ion-icon>
              <ion-card-title>Consumers</ion-card-title>
              <ion-card-subtitle>{{ totalConsumers }}</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ion-col>

        <!-- Meter Card -->
        <ion-col size="6">
          <ion-card class="stat-card meter-card">
            <ion-card-header>
              <ion-icon name="speedometer-outline"></ion-icon>
              <ion-card-title>Meters</ion-card-title>
              <ion-card-subtitle>25</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ion-col>

        <!-- Printer / Connection Card -->
        <ion-col size="12">
          <ion-card class="printer-card">
            <!-- Conditional rendering states -->
            @if (isScanning) {
            <div class="center-spinner">
              <ion-spinner color="primary"></ion-spinner>
              <p>Scanning for devices...</p>
            </div>
            } @if (!isScanning && !isConnected) {
            <ion-list class="devices">
              @for (device of devices; track device.address) {
              <ion-item
                (click)="connectDevice(device)"
                class="device"
                lines="none"
                detail="false"
                [button]="true"
              >
                <ion-icon
                  slot="start"
                  name="print-outline"
                  color="primary"
                ></ion-icon>
                <div class="device-wrapper">
                  <ion-label>{{ device.name }}</ion-label>
                  <ion-note>{{ device.address }}</ion-note>
                </div>
              </ion-item>
              }
            </ion-list>

            <ion-button
              expand="block"
              color="primary"
              (click)="presentSearchModal()"
            >
              <ion-icon slot="start" name="search"></ion-icon>
              Search Printers
            </ion-button>
            } @else if (isConnected) {
            <ion-button
              expand="block"
              color="success"
              [routerLink]="['/water-bill-reading']"
            >
              <ion-icon slot="start" name="document-text-outline"></ion-icon>
              Print Water Bill
            </ion-button>

            <ion-button
              expand="block"
              fill="outline"
              color="danger"
              (click)="disconnect()"
            >
              <ion-icon slot="start" name="power-outline"></ion-icon>
              Disconnect
            </ion-button>

            <ion-button expand="block" color="secondary">
              <ion-icon slot="start" name="swap-horizontal-outline"></ion-icon>
              Change
            </ion-button>
            } @else {
            <ion-button
              expand="block"
              fill="outline"
              color="warning"
              (click)="stopScan()"
            >
              <ion-icon slot="start" name="stop-circle-outline"></ion-icon>
              Stop Scanning
            </ion-button>
            }
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ion-content>
